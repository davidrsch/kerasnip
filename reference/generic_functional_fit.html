<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Internal Fitting Engine for Functional API Models — generic_functional_fit • kerasnip</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Internal Fitting Engine for Functional API Models — generic_functional_fit"><meta name="description" content="This function serves as the internal engine for fitting kerasnip models that
are based on the Keras functional API. It is not intended to be called
directly by the user. The function is invoked by parsnip::fit() when a
kerasnip functional model specification is used."><meta property="og:description" content="This function serves as the internal engine for fitting kerasnip models that
are based on the Keras functional API. It is not intended to be called
directly by the user. The function is invoked by parsnip::fit() when a
kerasnip functional model specification is used."><meta property="og:image" content="https://davidrsch.github.io/kerasnip/logo.png"><!-- Future google search metadata tag --><meta name="google-site-verification" content="kphyQu6n4JhBUuoLZxnJpD9dbw9q5FLwqXb9AkI2fhU"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">kerasnip</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/getting_started.html">Getting started</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-guides" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Guides</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-guides"><li><h6 class="dropdown-header" data-toc-skip>Model Definition</h6></li>
    <li><a class="dropdown-item" href="../articles/sequential_model.html">Sequential Model</a></li>
    <li><a class="dropdown-item" href="../articles/functional_api.html">Functional API</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/davidrsch/kerasnip"><span class="fa fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Internal Fitting Engine for Functional API Models</h1>

      <div class="d-none name"><code>generic_functional_fit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function serves as the internal engine for fitting <code>kerasnip</code> models that
are based on the Keras functional API. It is not intended to be called
directly by the user. The function is invoked by <code><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">parsnip::fit()</a></code> when a
<code>kerasnip</code> functional model specification is used.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">generic_functional_fit</span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, <span class="va">layer_blocks</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A formula specifying the predictor and outcome variables,
passed down from the <code><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">parsnip::fit()</a></code> call.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing the training data, passed down from the
<code><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">parsnip::fit()</a></code> call.</p></dd>


<dt id="arg-layer-blocks">layer_blocks<a class="anchor" aria-label="anchor" href="#arg-layer-blocks"></a></dt>
<dd><p>A named list of layer block functions. This is passed
internally from the <code>parsnip</code> model specification.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed down from the model specification.
These can include:</p><ul><li><p><strong>Layer Parameters:</strong> Arguments for the layer blocks, prefixed
with the block name (e.g., <code>dense_units = 64</code>).</p></li>
<li><p><strong>Architecture Parameters:</strong> Arguments to control the number
of times a block is repeated, in the format <code>num_{block_name}</code> (e.g.,
<code>num_dense = 2</code>).</p></li>
<li><p><strong>Compile Parameters:</strong> Arguments to customize model
compilation, prefixed with <code>compile_</code> (e.g., <code>compile_loss = "mae"</code>,
<code>compile_optimizer = "sgd"</code>).</p></li>
<li><p><strong>Fit Parameters:</strong> Arguments to customize model fitting,
prefixed with <code>fit_</code> (e.g., <code>fit_callbacks = list(...)</code>,
<code>fit_class_weight = list(...)</code>).</p></li>
</ul></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the fitted model and other metadata. This list is
stored in the <code>fit</code> slot of the <code>parsnip</code> model fit object. The list
contains the following elements:</p><ul><li><p><code>fit</code>: The raw, fitted Keras model object.</p></li>
<li><p><code>history</code>: The Keras training history object.</p></li>
<li><p><code>lvl</code>: A character vector of the outcome factor levels (for
classification) or <code>NULL</code> (for regression).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Generic Fitting Function for Functional Keras Models</p>
<p>The function orchestrates the three main steps of the model fitting process:</p><ol><li><p><strong>Build and Compile:</strong> It calls
<code>build_and_compile_functional_model()</code> to construct the Keras model
architecture based on the provided <code>layer_blocks</code> and hyperparameters.</p></li>
<li><p><strong>Process Data:</strong> It preprocesses the input (<code>x</code>) and output (<code>y</code>)
data into the format expected by Keras.</p></li>
<li><p><strong>Fit Model:</strong> It calls <code><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">keras3::fit()</a></code> with the compiled model
and processed data, passing along any fitting-specific arguments (e.g.,
<code>epochs</code>, <code>batch_size</code>, <code>callbacks</code>).</p></li>
</ol></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># This function is not called directly by users.</span></span></span>
<span class="r-in"><span><span class="co"># It is called internally by `parsnip::fit()`.</span></span></span>
<span class="r-in"><span><span class="co"># For example:</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># create_keras_functional_spec(...) defines my_functional_model</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="fu">my_functional_model</span><span class="op">(</span>hidden_units <span class="op">=</span> <span class="fl">128</span>, fit_epochs <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://parsnip.tidymodels.org/reference/set_engine.html" class="external-link">set_engine</a></span><span class="op">(</span><span class="st">"keras"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This call to fit() would invoke generic_functional_fit() internally</span></span></span>
<span class="r-in"><span><span class="va">fitted_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://generics.r-lib.org/reference/fit.html" class="external-link">fit</a></span><span class="op">(</span><span class="va">spec</span>, <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">training_data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Díaz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

