% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compile_keras_grid.R
\name{compile_keras_grid}
\alias{compile_keras_grid}
\title{Compile Keras Models over a Grid of Hyperparameters}
\usage{
compile_keras_grid(spec, grid, x, y)
}
\arguments{
\item{spec}{A \code{parsnip} model specification created by
\code{create_keras_sequential_spec()} or \code{create_keras_functional_spec()}.}

\item{grid}{A \code{tibble} or \code{data.frame} containing the grid of hyperparameters
to evaluate. Each row represents a unique model architecture to be compiled.}

\item{x}{A data frame or matrix of predictors. This is used to infer the
\code{input_shape} for the Keras model.}

\item{y}{A vector of outcomes. This is used to infer the output shape and
the default loss function.}
}
\value{
A \code{tibble} with the following columns:
\itemize{
\item Columns from the input \code{grid}.
\item \code{compiled_model}: A list-column containing the compiled Keras model
objects. If compilation failed for a specific hyperparameter set, this
column will contain a character string with the error message.
\item \code{model_summary}: A list-column containing a character string with the
output of \code{keras3::summary_keras_model()} for each successfully compiled
model.
}
}
\description{
This function allows you to build and compile multiple Keras models based on a
\code{parsnip} model specification and a grid of hyperparameters, without actually
fitting them. It's a valuable tool for validating model architectures and
catching potential errors early in the modeling process.
}
\details{
The function operates by iterating through each row of the provided \code{grid}.
For each combination of hyperparameters, it:
\enumerate{
\item Constructs the appropriate Keras model (Sequential or Functional) based
on the \code{spec}.
\item Compiles the model using the specified optimizer, loss, and metrics.
\item Wraps the process in a \code{try-catch} block to gracefully handle any
errors that might occur during model instantiation or compilation (e.g.,
due to incompatible layer shapes or invalid argument values).
}
The output is a \code{tibble} where each row corresponds to a row in the input
\code{grid}. It includes the original hyperparameters, the compiled Keras model
object (or a string with the error message if compilation failed), and a
summary of the model's architecture.
}
